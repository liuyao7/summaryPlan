# V8 & js Core

Js执行顺序
1. source code => AST => byte code => 汇编语言
2. 在运行 C、C++以及 Java 等程序之前，需要进行编译，不能直接执行源码；但对于 JavaScript 来说，我们可以直接执行源码(比如：node test.js)，它是在运行的时候先编译再执行，这种方式被称为即时编译(Just-in-time compilation)，简称为 JIT。因此，V8 也属于 JIT 编译器。

JavaScriptCore主要模块：
1. Lexer 词法分析器，将脚本源码分解成一系列的Token
2. Parser 语法分析器，处理Token并生成相应的语法树
3. LLInt 低级解释器，执行Parser生成的二进制代码
4. Baseline JIT 基线JIT（just in time 实时编译）
5. DFG 低延迟优化的JIT
6. FTL 高通量优化的JIT

V8 本质上是一个虚拟机，因为计算机只能识别二进制指令，所以要让计算机执行一段高级语言通常有两种手段：
* 第一种是将高级代码转换为二进制代码，再让计算机去执行；
* 另外一种方式是在计算机安装一个解释器，并由解释器来解释执行。
* 解释执行和编译执行都有各自的优缺点，解释执行启动速度快，但是执行时速度慢，而编译执行启动速度慢，但是执行速度快。为了充分地利用解释执行和编译执行的优点，规避其缺点，V8 采用了一种权衡策略，在启动过程中采用了解释执行的策略，但是如果某段代码的执行频率超过一个值，那么 V8 就会采用优化编译器将其编译成执行效率更加高效的机器代码。

简单总结如下，V8 执行一段 JavaScript 代码所经历的主要流程包括：
* 初始化基础环境；
* 解析源码生成 AST 和作用域；
* 依据 AST 和作用域生成字节码；
* 解释执行字节码；
* 监听热点代码；
* 优化热点代码为二进制的机器代码；
* 反优化生成的二进制机器代码。

